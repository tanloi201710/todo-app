{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _Device = require('../Device');\n\nvar _Device2 = _interopRequireDefault(_Device);\n\nvar _logger = require('../logger');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar logger = new _logger2.default('SSO.Facebook');\nvar default_options = {\n  facebook_app_id: null,\n  script: 'https://connect.facebook.net/en_US/sdk.js',\n  scope: 'public_profile,email'\n  /**\n  * Reference: https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus\n  */\n\n};\n\nvar Facebook = function () {\n  function Facebook(options) {\n    _classCallCheck(this, Facebook);\n\n    if (typeof options === 'string') {\n      options = {\n        facebook_app_id: options\n      };\n    }\n\n    this._options = Object.assign({}, default_options, options);\n\n    if (!this._options.facebook_app_id) {\n      logger.warn('missing facebook_app_id');\n    }\n\n    this.signIn = this.signIn.bind(this);\n    this.signOut = this.signOut.bind(this);\n    this.check = this.check.bind(this);\n    this.ready = this.ready.bind(this);\n    this._fbAsyncInit = this._fbAsyncInit.bind(this);\n    this._user = this._user.bind(this);\n    this._fb = null;\n\n    this._createScript();\n  }\n\n  _createClass(Facebook, [{\n    key: 'signIn',\n    value: function signIn() {\n      var _this = this;\n\n      var fb = this._fb;\n\n      if (!fb) {\n        return Promise.reject('no fb instance');\n      }\n\n      var scope = this._options.scope;\n      return this.check().then(function (authResponse) {\n        return _this._user(authResponse);\n      }).catch(function (err) {\n        return new Promise(function (resolve, reject) {\n          fb.login(function (response) {\n            resolve(_this._user(response.authResponse));\n          }, {\n            scope: scope\n          });\n        });\n      });\n    }\n  }, {\n    key: 'signOut',\n    value: function signOut() {\n      var fb = this._fb;\n\n      if (!fb) {\n        return Promise.reject('no fb instance');\n      }\n\n      return new Promise(function (resolve, reject) {\n        fb.logout(function (response) {\n          logger.debug('signed out', response);\n          resolve();\n        });\n      });\n    }\n  }, {\n    key: 'check',\n    value: function check() {\n      var fb = this._fb;\n\n      if (!fb) {\n        return Promise.reject('no fb instance');\n      }\n\n      return new Promise(function (resolve, reject) {\n        fb.getLoginStatus(function (response) {\n          if (response.status === 'connected') {\n            resolve(response.authResponse);\n          } else {\n            reject(response);\n          }\n        });\n      });\n    }\n  }, {\n    key: 'ready',\n    value: function ready() {\n      var facebook_app_id = this._options.facebook_app_id;\n\n      if (!facebook_app_id) {\n        return Promise.reject('missing facebook_app_id in props');\n      }\n\n      var that = this;\n      return new Promise(function (resolve, reject) {\n        var checkCount = 0;\n\n        var checkFB = function checkFB() {\n          checkCount++;\n\n          if (that._fb) {\n            resolve();\n            return;\n          }\n\n          if (window.FB) {\n            that._fb = window.FB;\n            resolve();\n            return;\n          }\n\n          if (checkCount < 5) {\n            window.setTimeout(checkFB, 500);\n          } else {\n            reject('timeout');\n          }\n        };\n\n        checkFB();\n      });\n    }\n  }, {\n    key: '_user',\n    value: function _user(authResponse) {\n      if (!authResponse) {\n        return Promise.reject('no authResponse');\n      }\n\n      var accessToken = authResponse.accessToken,\n          userID = authResponse.userID;\n\n      if (!accessToken) {\n        return Promise.reject('no accessToken');\n      }\n\n      var fb = this._fb;\n      return new Promise(function (resolve, reject) {\n        fb.api('/me', function (response) {\n          var user = {\n            accessToken: accessToken,\n            userID: userID,\n            name: response.name\n          };\n          logger.debug('user', user);\n          resolve(user);\n        });\n      });\n    }\n  }, {\n    key: '_fbAsyncInit',\n    value: function _fbAsyncInit() {\n      logger.debug('init FB');\n      var facebook_app_id = this._options.facebook_app_id;\n\n      if (!facebook_app_id) {\n        logger.warn('missing facebook_app_id in props');\n        return;\n      }\n\n      var fb = window.FB;\n      fb.init({\n        appId: facebook_app_id,\n        cookie: true,\n        xfbml: true,\n        version: 'v2.11'\n      });\n      this._fb = fb;\n    }\n  }, {\n    key: '_createScript',\n    value: function _createScript() {\n      if (window.FB) {\n        this._fbAsyncInit();\n\n        return;\n      }\n\n      var script = this._options.script;\n\n      if (script === 'none') {\n        if (window.FB) {\n          this._fb = window.FB;\n        }\n\n        return;\n      }\n\n      window.fbAsyncInit = this._fbAsyncInit;\n\n      _Device2.default.createScript(this._options.script, true);\n    }\n  }]);\n\n  return Facebook;\n}();\n\nexports.default = Facebook;","map":{"version":3,"sources":["/home/tanloi/Documents/React/todo-app/node_modules/fsts/lib/sso/Facebook.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_Device","require","_Device2","_interopRequireDefault","_logger","_logger2","obj","__esModule","default","_classCallCheck","instance","TypeError","logger","default_options","facebook_app_id","script","scope","Facebook","options","_options","assign","warn","signIn","bind","signOut","check","ready","_fbAsyncInit","_user","_fb","_createScript","_this","fb","Promise","reject","then","authResponse","catch","err","resolve","login","response","logout","debug","getLoginStatus","status","that","checkCount","checkFB","window","FB","setTimeout","accessToken","userID","api","user","name","init","appId","cookie","xfbml","version","fbAsyncInit","createScript"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Device = require('../Device');\n\nvar _Device2 = _interopRequireDefault(_Device);\n\nvar _logger = require('../logger');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar logger = new _logger2.default('SSO.Facebook');\n\nvar default_options = {\n    facebook_app_id: null,\n    script: 'https://connect.facebook.net/en_US/sdk.js',\n    scope: 'public_profile,email'\n\n    /**\n    * Reference: https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus\n    */\n};\nvar Facebook = function () {\n    function Facebook(options) {\n        _classCallCheck(this, Facebook);\n\n        if (typeof options === 'string') {\n            options = { facebook_app_id: options };\n        }\n        this._options = Object.assign({}, default_options, options);\n        if (!this._options.facebook_app_id) {\n            logger.warn('missing facebook_app_id');\n        }\n\n        this.signIn = this.signIn.bind(this);\n        this.signOut = this.signOut.bind(this);\n        this.check = this.check.bind(this);\n        this.ready = this.ready.bind(this);\n\n        this._fbAsyncInit = this._fbAsyncInit.bind(this);\n        this._user = this._user.bind(this);\n\n        this._fb = null;\n\n        this._createScript();\n    }\n\n    _createClass(Facebook, [{\n        key: 'signIn',\n        value: function signIn() {\n            var _this = this;\n\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            var scope = this._options.scope;\n\n            return this.check().then(function (authResponse) {\n                return _this._user(authResponse);\n            }).catch(function (err) {\n                return new Promise(function (resolve, reject) {\n                    fb.login(function (response) {\n                        resolve(_this._user(response.authResponse));\n                    }, { scope: scope });\n                });\n            });\n        }\n    }, {\n        key: 'signOut',\n        value: function signOut() {\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            return new Promise(function (resolve, reject) {\n                fb.logout(function (response) {\n                    logger.debug('signed out', response);\n                    resolve();\n                });\n            });\n        }\n    }, {\n        key: 'check',\n        value: function check() {\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            return new Promise(function (resolve, reject) {\n                fb.getLoginStatus(function (response) {\n                    if (response.status === 'connected') {\n                        resolve(response.authResponse);\n                    } else {\n                        reject(response);\n                    }\n                });\n            });\n        }\n    }, {\n        key: 'ready',\n        value: function ready() {\n            var facebook_app_id = this._options.facebook_app_id;\n\n            if (!facebook_app_id) {\n                return Promise.reject('missing facebook_app_id in props');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                var checkCount = 0;\n                var checkFB = function checkFB() {\n                    checkCount++;\n                    if (that._fb) {\n                        resolve();\n                        return;\n                    }\n\n                    if (window.FB) {\n                        that._fb = window.FB;\n                        resolve();\n                        return;\n                    }\n\n                    if (checkCount < 5) {\n                        window.setTimeout(checkFB, 500);\n                    } else {\n                        reject('timeout');\n                    }\n                };\n                checkFB();\n            });\n        }\n    }, {\n        key: '_user',\n        value: function _user(authResponse) {\n            if (!authResponse) {\n                return Promise.reject('no authResponse');\n            }\n            var accessToken = authResponse.accessToken,\n                userID = authResponse.userID;\n\n            if (!accessToken) {\n                return Promise.reject('no accessToken');\n            }\n\n            var fb = this._fb;\n            return new Promise(function (resolve, reject) {\n                fb.api('/me', function (response) {\n                    var user = {\n                        accessToken: accessToken,\n                        userID: userID,\n                        name: response.name\n                    };\n\n                    logger.debug('user', user);\n                    resolve(user);\n                });\n            });\n        }\n    }, {\n        key: '_fbAsyncInit',\n        value: function _fbAsyncInit() {\n            logger.debug('init FB');\n\n            var facebook_app_id = this._options.facebook_app_id;\n\n            if (!facebook_app_id) {\n                logger.warn('missing facebook_app_id in props');\n                return;\n            }\n\n            var fb = window.FB;\n            fb.init({\n                appId: facebook_app_id,\n                cookie: true,\n                xfbml: true,\n                version: 'v2.11'\n            });\n            this._fb = fb;\n        }\n    }, {\n        key: '_createScript',\n        value: function _createScript() {\n            if (window.FB) {\n                this._fbAsyncInit();\n                return;\n            }\n\n            var script = this._options.script;\n\n            if (script === 'none') {\n                if (window.FB) {\n                    this._fb = window.FB;\n                }\n                return;\n            }\n\n            window.fbAsyncInit = this._fbAsyncInit;\n            _Device2.default.createScript(this._options.script, true);\n        }\n    }]);\n\n    return Facebook;\n}();\n\nexports.default = Facebook;"]},"metadata":{},"sourceType":"script"}